# ALDE-
Алгоритм направленной эволюции, основанный на кластеризации с моделью Гауссовского процесса 

  Инженерия белков — это задача оптимизации, целью которой является поиск аминокислотной последовательности, 
  которая максимизирует «пригодность» — количественную оценку эффективности или функциональности для желаемого применения.
  Оптимизацию пригодности белков можно рассматривать как поиск вариантов с более высокой пригодностью в ландшафте пригодности белков,
  где аминокислотные последовательности сопоставляются со значениями пригодности, чтобы найти варианты с более высокой пригодностью.
  Однако, поскольку пространство последовательностей белков огромно, а белок длиной N может иметь 20 N различных последовательностей,
  оптимальную последовательность найти сложно, поэтому часто используют направленную эволюцию с машинным обучением для ускорения поиска функциональных белков.

  Цель: изучить и адаптировать уже существующие алгоритмы in silico направленной эволюции белков с применением методов машинного обучения для проверки
  связи между физической характеристикой и функциональностью.

  Кодирование белков
  Преобразование аминокислот в числовые векторы необходимо для моделей машинного обучения. Существует несколько способов закодировать белок:
•	AAIndex — это база данных числовых показателей, представляющих различные физико-химические и биохимические свойства аминокислот и пар аминокислот.
•	Onehot — это метод представления категориальных данных в виде бинарных векторов
•	ESM2 – это кодировщик, который используется в языковой модели для предсказания структуры белка, функциональной аннотации и других задач биоинформатики. 
 
  В данном случае будет использована кодировка о направлении гидрофобного момента из базы данных AAindex.
  <img width="606" height="694" alt="image" src="https://github.com/user-attachments/assets/ad59a7db-421a-44bc-9808-eee757995bfd" />
  
  Преобразование последовательности аминокислот в вектор 
  <img width="793" height="513" alt="image" src="https://github.com/user-attachments/assets/6abec4c2-9703-4aaa-8a57-3aeb4a8077a1" />
  
  Кластеризация последовательностей алгоритмом CLADE
  1)	Разделение выборки на кластеры с помощью метода K-means. 
  Разделение K-means основано на создании центров, причем они выбираются произвольно.
  Каждый центр обладает своей координатой в n-мерном пространстве (в данном случае 3-х мерном, так как меняющихся аминокислот всего 3.
  Затем считается расстояние каждой комбинации   до центра. Аминокислота принадлежит тому центру, до которого меньшее расстояние.

  К-means кластеризация аминокислотных последовательностей
  <img width="833" height="580" alt="image" src="https://github.com/user-attachments/assets/7211db1c-7128-4833-b926-511975a8c3e8" />

  2)	Использование моделей, таких как Profile HMM, EVmutation, DeepSequence VAE, MSA Transformer и ESM-1v Transformer, для ранжирования последовательностей в кластере.
     Каждая модель дает эволюционную оценку. В данном алгоритме мы не будем использовать ни одну из моделей.Во-первых, на данный момент мы изучаем как рассчитывать
     спектральную полосу молекул с помощью пакетов молекулярной динамики (dowser++).
     Полученные расчеты максимумов поглощения будут являться функциональной характеристикой белка. 
     Во-вторых, разбор и реализация данных моделей в коде требует достаточного количества времени, которого сейчас нет.

  3)	По значению вероятности каждого кластера разделим кластеры на под кластеры по формуле:
     <img width="656" height="172" alt="image" src="https://github.com/user-attachments/assets/01c1c2b5-7fff-4ad3-8057-9710abad155f" />,
    	где <img width="352" height="64" alt="image" src="https://github.com/user-attachments/assets/9e9ab750-1afe-429b-8270-9dc461cb18ba" />

  Ki всего кластеров на уровне h (в данном случае уровень 1, так как дробления не было)
  Чем больше вероятность ( ~ функциональность кластера), тем он сильнее дробится.  
  
  4)	Далее рассчитываем вероятность подкластеров по формуле:
     
  <img width="417" height="155" alt="image" src="https://github.com/user-attachments/assets/0d01894a-74b1-468c-9b4f-c2354dd550b5" />,
      
  где 
    •	#Ck: Количество последовательностей в k-м кластере.
    •	yi – функциональность белка 
    При втором дроблении используется значения функциональности, которые рассчитываются с помощью ПО и моделей машинного обучения, о которых будет рассказано в следующих пунктах.

  6)	Выполнить шаг 3– 4 до тех пор, пока большинство кластеров не будут пустыми, так как последовательностей не будет хватать, чтобы разделить в новые группы.
     
  7)	Получили кластеры с наибольшей функциональностью

  Расчет функциональности белка 
  
  Функциональность белка будет представлена как характеристика поглощения молекулы (в нм). Как было сказано ранее, на данный момент мы изучаем как производить такие расчеты. 
  Так как мы не будем иметь размеченные данные для модели, то для 100 комбинаций получим значения с помощью произвольной функции, которая определяет функциональность.
  
  Мы выбрали функцию, указанную ниже 

  <img width="909" height="93" alt="image" src="https://github.com/user-attachments/assets/a9e7fd28-79cb-4e39-a839-1489a57e9fb7" />

   Расчёт машинного обучения
   
  После того, как мы рассчитали функциональность нескольких белков, можем использовать модель Гауссовского процесса, которая позволит рассчитать на основе изученных 
  ранее множеств [[x 11, x12, x13, x14], [x21, x22, x23, x24]…] (закодированные аминокислоты) и [y1, y2, ….]  (значения функциональности) значения функциональности для остальных белков.
  На самом деле, данный шаг вариабельный. Можно использовать различные модели машинного обучения. На рисунке ниже приведена схема, объясняющая какую модель машинного обучения использовать в различных ситуациях.
  
  <img width="845" height="454" alt="image" src="https://github.com/user-attachments/assets/0b316918-d921-47c6-a9f5-b3836c1424f3" />
  
  Ресурс : Yang, K. K., Wu, Z., & Arnold, F. H. (2019b). Machine-learning-guided directed evolution for protein engineering. Nature Methods, 16(8), 687–694. https://doi.org/10.1038/s41592-019-0496-6

  Гауссовский процесс относится к классу случайных/стохастических процессов, определяющих наблюдаемые значения случайных величин, которые эволюционируют в пространстве и/или времени.
  Во многих приложениях регрессии Гауссовского процесса принято моделировать обучающие цели «y», как зашумленные наблюдаемые Гауссовского процесса «f»,
  где шум параметризован нулевым средним гауссовским значением с положительной ковариацией шума, заданной σ².

  <img width="377" height="97" alt="image" src="https://github.com/user-attachments/assets/61928b2c-9ef7-45e6-a248-f2892d8b159b" />

  Если даны точки X={x1,…,xn} и значения f={f(x1),…,f(xn)}, то:
  f∼N(m,K), где:
  m=[m(x1),…,m(xn)]T — вектор средних,
  K — ковариационная матрица, где Kij=k(xi,xj).  

  Популярные ковариационные функции (ядра):
  
  <img width="606" height="157" alt="image" src="https://github.com/user-attachments/assets/6b1081b7-d4e8-41bb-999c-3ace207a0820" />

  Указанные выше выкладки позволяют определить y*- предсказанное значение, для которого верно:

  <img width="613" height="96" alt="image" src="https://github.com/user-attachments/assets/445f3b96-4fe5-4ef9-8b9a-c983e0a93350" />

  а условное распределение для предсказания:
  
  <img width="391" height="80" alt="image" src="https://github.com/user-attachments/assets/25b22901-7132-4edf-aa15-ece308c4e677" />
   
   где 
   
   <img width="669" height="72" alt="image" src="https://github.com/user-attachments/assets/e181c1c2-66f4-43cb-b5a1-1cee35aabf15" />

   <img width="728" height="70" alt="image" src="https://github.com/user-attachments/assets/72214aa1-712e-4b02-be03-e76becccef30" />
   

   Теперь приведем пример, как модель-GP предсказывает наши данные. Так как пространство аминокислот 3-x мерное, а теперь еще добавляется ось функциональности, получаем 4-х мерное пространство, которое мы никак не изобразим. Поэтому зафиксируем две               аминокислоты и будем варьировать одну аминокислоту. Рассчитаем для нее реальное значение функциональности (использована функция, изображенная на рис. 4 и предсказанное. Так как мы используем модель стохастическую, то для нее мы можем построить                 доверительный интервал (в данном случае 95%). Мы приведем два результата, чтобы показать, как меняется доверительный интервал с увеличением обучающей выборки.

  График при обучающей выборке равной 10 
  
   <img width="775" height="418" alt="image" src="https://github.com/user-attachments/assets/38c959e5-a6f1-4f86-8843-b7b276a4a895" />

  График при обучающей выборке равной 20
  
  <img width="856" height="484" alt="image" src="https://github.com/user-attachments/assets/951719f1-6840-4487-a4eb-76e507317942" />

  

  КОНЕЧНЫЙ РЕЗУЛЬТАТ

  Результатом являются кластеры с аминокислотами обладающие большой фитностью 

  <img width="974" height="470" alt="image" src="https://github.com/user-attachments/assets/5113d050-39fc-4abc-914c-7fea46552971" />

  <img width="974" height="608" alt="image" src="https://github.com/user-attachments/assets/2afb9f5f-165c-4fe2-9934-9d7db7983e3a" />

  Последовательности с наилучшей функциональностью

  <img width="453" height="609" alt="image" src="https://github.com/user-attachments/assets/736bb07c-17f4-4879-9d49-ea62c7de0c3f" />







  











     





  





